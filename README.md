# Package Inspector

Система контроля качества упаковки с использованием компьютерного зрения.

## Описание

Package Inspector — веб-приложение для автоматизированного контроля качества упаковки. Система сравнивает тестовое изображение с эталонным и выявляет отклонения: отсутствующие или лишние элементы.

## Технологии

### Backend

- Python 3.12
- Flask 3.0.0
- OpenCV 4.10.0
- NumPy 1.26.4

### Frontend

- HTML5
- Tailwind CSS 4.1.18
- Vanilla JavaScript

## Установка

### Требования

- Python 3.12+
- pnpm 10+

### Шаги установки

1. Клонировать репозиторий:

```bash
git clone <repository-url>
cd package-inspector
```

2. Создать и активировать виртуальное окружение:

```bash
python3.12 -m venv venv
source venv/bin/activate
```

3. Установить Python зависимости:

```bash
venv/bin/pip install -r backend/requirements.txt
```

4. Установить frontend зависимости:

```bash
cd frontend
pnpm install
```

5. Собрать CSS:

```bash
pnpm run build:css
```

## Сборка и запуск

### Сборка frontend

Перед первым запуском соберите CSS:

```bash
cd frontend
pnpm run build:css
```

### Запуск приложения

Из корневой директории проекта:

```bash
venv/bin/python backend/run.py
```

Приложение будет доступно по адресу: http://localhost:3000

### Запуск тестов

```bash
venv/bin/pytest backend/tests/
```

## Использование

1. Откройте браузер и перейдите на http://localhost:3000
2. Загрузите эталонное изображение в левую область
3. Загрузите тестовое изображение в правую область
4. Нажмите кнопку "Сравнить изображения"
5. Просмотрите результаты:
   - Оценка сходства в процентах
   - Количество обнаруженных отклонений
   - Аннотированное изображение с выделенными областями отклонений

## Структура проекта

```
package-inspector/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── config.py
│   │   ├── routes.py
│   │   ├── image_utils.py
│   │   ├── comparator.py
│   │   └── annotator.py
│   ├── uploads/
│   ├── requirements.txt
│   └── run.py
├── frontend/
│   ├── static/
│   │   ├── css/
│   │   └── js/
│   ├── templates/
│   ├── package.json
│   └── tailwind.config.js
└── README.md
```

## Конфигурация

Параметры системы можно настроить в `backend/app/config.py`:

- `SIMILARITY_THRESHOLD` - порог сходства (0.0-1.0)
- `MIN_DEFECT_AREA` - минимальная площадь дефекта в пикселях
- `DIFF_THRESHOLD` - порог различия пикселей (0-255)
- `MORPHOLOGY_KERNEL_SIZE` - размер ядра для морфологических операций

## Алгоритм работы

1. **Загрузка и валидация** изображений
2. **Приведение к одному размеру** тестового изображения
3. **Template Matching** для оценки общего сходства
4. **Попиксельное сравнение** в оттенках серого
5. **Морфологические операции** для фильтрации шума
6. **Поиск контуров** отклонений
7. **Аннотация** найденных областей на изображении

## Лицензия

ISC
